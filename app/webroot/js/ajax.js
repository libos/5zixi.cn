function readCookie(a){var b="",c=a+"]=";return document.cookie.length>0&&(offset=document.cookie.indexOf(c),-1!=offset&&(offset+=c.length,end=document.cookie.indexOf("%26",offset),-1==end&&(end=document.cookie.length),b=document.cookie.substring(offset,end))),b}function writeCookie(a,b){var c=300,d=new Date;d.setTime(d.getTime()+1e3*60*60*24*c),document.cookie=a+"="+b+"&expires="+d.toGMTString()}function escape2(a){return escape(a).replace(/\+/g,"%2b")}function cookieCheck(){""!=readCookie("uid")?(loginxx(),document.getElementById("LoginSuc").style.display="block"):document.getElementById("Login").style.display="block"}function keyEnter13(a,b){13==b.keyCode&&document.getElementById(a).click()}function loginxx(){var a={action:"CheckLogin",State:"1"};$.ajax({type:"post",url:"/login",dataType:"text",data:a,success:function(a){""!=a&&(document.getElementById("LoginSuc").innerHTML=a)},error:function(){}})}function nouseLogin(a){0==a&&(""!=readCookie("uid")?document.getElementById("i_loginsuc").style.display="block":document.getElementById("i_login").style.display="block");var c="",d="",e=0;if(1==a){if(c=document.getElementById("txtUser").value,d=document.getElementById("txtPass").value,!c||!d)return;1==document.getElementById("expires").checked&&(e=365e4),document.getElementById("LoginBtn").disabled=!0}var f={action:"nouseLogin",State:a,User:escape(c),Pass:d,Expires:escape2(e)};$.ajax({type:"post",url:"/login",dataType:"text",data:f,success:function(a){"LoginOut"==a?(document.getElementById("i_loginsuc").style.display="none",document.getElementById("i_login").style.display="block",document.getElementById("LoginSuc").style.display="none",document.getElementById("Login").style.display="block",document.getElementById("LoginBtn").disabled=!1,document.getElementById("txtPass").value=""):"Error"==a?alert("账号或密码错误！"):""!=a&&(document.getElementById("i_loginsuc").innerHTML=a,document.getElementById("i_login").style.display="none",document.getElementById("i_loginsuc").style.display="block",cookieCheck()),document.getElementById("LoginBtn").disabled=!1},error:function(){}})}function getUrlVars(){for(var b,a=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)b=c[d].split("="),a.push(b[0]),a[b[0]]=b[1];return a}function homepageuserlogin(){var a=$("#login_slug").val(),b=$("#login_password").val(),c=0;if(!a||!b)return document.getElementById("Login_Text").innerHTML="账号和密码不能为空！",void 0;(document.getElementsByName("Login_Exp").checked=!0)&&(c=365e4),document.getElementById("EnterOper").disabled=!0;var d={action:"homepageuserlogin",slug:escape(a),password:md5(b),Expires:escape2(c)};$.ajax({type:"post",url:"/login",dataType:"text",data:d,success:function(a){if("Login"==a){var b=getUrlVars().url;b||(b="/home"),parent.location=b}else document.getElementById("Login_Text").innerHTML="账号或密码错误！",document.getElementById("EnterOper").disabled=!1},error:function(){}})}