function sl(a){for(sl1=a.length,strLen=0,i=0;sl1>i;i++)a.charCodeAt(i)>255?strLen+=2:strLen++;return strLen}function CheckUser(){var a=!0;if(a){var b=document.getElementById("d_uname"),c=document.getElementById("slug").value,d={action:"checkSlug",slug:c};$.ajax({type:"post",url:"/ajax_validate",dataType:"text",data:d,success:function(a){"OK"==a?(b.className="d_ok",b.innerHTML="用户名可以使用。",document.getElementById("d_uname_img").src=li_ok):(b.className="d_err",b.innerHTML="该用户已存在。",document.getElementById("d_uname_img").src=li_err)},error:function(){alert("数据提交失败，请检查网络或重试。")}})}return a}function chk_reg(){var a=!0;if(out_uname()||(a=!1),out_upwd1()||(a=!1),out_upwd2()||(a=!1),out_email()||(a=!1),out_code()||(a=!1),out_agree()||(a=!1),a){for(var b=document.getElementById("slug").value,c=document.getElementById("password").value,d=document.getElementById("email").value,e="0",f=document.getElementById("code").value,g=document.getElementsByName("sex"),h=0;h<g.length;h++)g[h].checked&&(e=g[h].value);var i={action:"UserAdd",code:f,slug:escape(b),password:c,email:d,sex:e};return $.ajax({type:"post",url:"/register",dataType:"text",data:i,success:function(a){"OK"==a?(document.getElementById("ob_reg").style.display="none",document.getElementById("regSuc").style.display="block",cookieCheck(),document.getElementById("Login").style.display="none"):alert("用户名含有禁止字符！"),document.getElementById("regbotton").disabled=!1},error:function(){alert("数据提交失败，请检查网络或重试。")}}),void 0}}function out_uname(){var a=document.getElementById("d_uname"),b=document.getElementById("slug").value,c=sl(b),d=!0;return(4>c||c>14)&&(d=!1),d?CheckUser():(a.className="d_err",a.innerHTML=msg[0],document.getElementById("d_uname_img").src=li_err),d}function out_email(){var a=document.getElementById("d_email"),b=document.getElementById("email").value,c=!0;if(""!=b&&b.match(/^[\w\.\-]+@([\w\-]+\.)+[a-z]{2,4}$/gi)||(c=!1),c){var d=document.getElementById("email").value,e={action:"checkEmail",email:d};$.ajax({type:"post",url:"/ajax_validate",dataType:"text",data:e,success:function(b){"OK"==b?(a.className="d_ok",a.innerHTML="Email可以使用。",document.getElementById("d_uname_img").src=li_ok):(a.className="d_err",a.innerHTML="该Email已存在。",document.getElementById("d_uname_img").src=li_err)},error:function(){alert("数据提交失败，请检查网络或重试。")}})}else a.className="d_err",a.innerHTML=msg[6],document.getElementById("d_email_img").src=li_err;return c}function out_agree(){var a=document.getElementById("d_agree"),b=!0;return 0==document.getElementById("agreebox").checked&&(b=!1),b?(a.className="d_ok",a.innerHTML="",document.getElementById("d_agree_img").src=li_ok):(a.className="d_err",a.innerHTML=msg[7],document.getElementById("d_agree_img").src=li_err),b}function out_code(){var a=document.getElementById("d_code"),b=document.getElementById("code").value,c={code:b};return $.ajax({type:"post",url:"/captch_valid",dataType:"text",data:c,success:function(b){"ok"==b?(a.className="d_ok",a.innerHTML="验证码输入正确。",document.getElementById("d_code_img").src=li_ok):(a.className="d_err",a.innerHTML=msg[5],document.getElementById("d_code_img").src=li_err)},error:function(){alert("数据提交失败，请检查网络或重试。")}}),"d_ok"==a.className}function out_upwd1(){var a=document.getElementById("d_upwd1"),b=document.getElementById("password").value,c=!0;return-1!=b.indexOf(" ")&&(c=!1),(""==b||b.length<6||b.length>14)&&(c=!1),c?(a.className="d_ok",a.innerHTML="密码已经输入。",document.getElementById("d_upwd1_img").src=li_ok):(a.className="d_err",a.innerHTML=msg[2],document.getElementById("d_upwd1_img").src=li_err),c}function out_upwd2(){var a=document.getElementById("d_upwd2"),b=document.getElementById("password_confirm").value,c=!0;return(b!=document.getElementById("password").value||""==b)&&(c=!1),c?(a.className="d_ok",a.innerHTML="重复密码输入正确。",document.getElementById("d_upwd2_img").src=li_ok):(a.className="d_err",a.innerHTML=msg[3],document.getElementById("d_upwd2_img").src=li_err),c}function on_input(a){var b,c=document.getElementById(a);switch(c.className="d_on",a){case"d_uname":b=msg[0];break;case"d_udomain":b=msg[1];break;case"d_upwd1":b=msg[2];break;case"d_upwd2":b=msg[3];break;case"d_code":b=msg[5];break;case"d_email":b=msg[6];case"d_agree":b=msg[7]}c.innerHTML=b}function DispPwdStrength(a,b){a>3&&(a=3);for(var c=1;4>c;c++){var d="ob_pws0";a>=c&&(d=b),a>0&&(document.getElementById("idSM"+c).className=d),a>0?a>=c&&(document.getElementById("idSMT"+c).style.display=c==a?"inline":"none"):document.getElementById("idSMT"+c).style.display=c==a?"none":"inline"}}var msg,li_ok="/img/li_ok.png",li_err="/img/li_err.gif",msg=new Array("请输入4-14位字符，英文、数字的组合。","请输入4-14位字符，英文、数字的组合。","请输入6位以上字符，不允许空格。","请重复输入上面的密码。","请选择密码提示问题。","请输入提示的验证码","请输入您常用的电子邮箱地址。","必须同意注册协议才能注册。");